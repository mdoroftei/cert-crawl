var vows = require('vows'),
		assert = require('assert');

var amqp = require('../index.js');


vows.describe('amqp module').addBatch({
	'when init called':{
		topic: function(){
				amqp.factory({host: 'rabbitmq-03.devel.nimbus'}, this.callback);
		},
		'there should be no  error': function(err, object, default_name){
				assert.isNull(err);
			},
		'should have declare_exchange method': function(err, object, default_name){
			assert.isFunction(object.declare_exchange);
		},
		'the __init_exchange method should be `private`': function(err, object, default_name){
			assert.isFunction(object.__init_exchange);
		},
		'should have declare_init method' : function(err, object, default_name){
			assert.isFunction(object.declare_queue);
		},
		'the __init_queue method should be `private`': function(err, object, default_name){
			assert.isFunction(object.__init_queue);
		},
		'close should work': function (err, object, default_name){
			object.close();
		}
	},
 'when init called with empty options' : {
	 topic: function(){
		 amqp.factory({}, this.callback);
	 },
	 'there should be a error': function(err, amqp){
		 assert.isNotNull(err);
	 }
 }
	 
}).export(module);

