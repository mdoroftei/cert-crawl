
var amqp = require('../index.js');
console.log(amqp);

var amqp_object = null;
amqp.factory({
		host : ['rabbitmq-03.devel.nimbus'],
		queues : { test: { prefetch_count : 100,  durable:true, autoDelete:false, bind: {exchange: 'hq_tasks', routing_key: "lalala"} }}
	},
	function(err, a){
		amqp_object = a;
		console.log("Amqp ready");

        // Daca nu tratez aici eroare iese din program
        a.on('error', function(err){
            console.log("Error", err);
        });
    }
);

var count = 0;

function got_message(msg, headers, deliveryInfo, message){
//	console.log(msg);
	message.acknowledge();
//    message.acknowledge();
}


