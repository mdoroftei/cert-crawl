
var amqp = require('../index.js');
console.log(amqp);

var amqp_object = null;
amqp.factory({
	queues : { hq_mongo_write_nimbus_ih_cleanset : { prefetch_count : 100, on_message: got_message, durable:true, autoDelete:false}},
	heartbeat: 1
   },
	function(err, a){
		amqp_object = a;
		console.log("Amqp ready", err);

        // Daca nu tratez aici eroare iese din program
        a.on('error', function(err){
            console.log("Error", err);
		});
        a.on('warn', function(err){
            console.log("warn ", err);
		});
    }
);

var count = 0;

function got_message(msg, headers, deliveryInfo, message){
	console.log(msg);
//	message.acknowledge();
}


